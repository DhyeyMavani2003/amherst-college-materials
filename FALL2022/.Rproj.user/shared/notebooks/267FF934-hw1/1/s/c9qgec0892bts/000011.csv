"0","# Chapter 2 application example"
"0",""
"0","# Import lpSolve package"
"0","library(lpSolve)"
"0",""
"0","# Network flow example"
"0",""
"0","# Assumes non-negative solutions!"
"0",""
"0","# Set coefficients of the objective function"
"0","f.obj <- c(1,1,rep(0,8))"
"0",""
"0","# Set matrix corresponding to coefficients of constraints by rows"
"0","f.con <- matrix(c(1,0,-1,-1,-1,rep(0,5),"
"0","                  0,1,1,0,0,-1,1,rep(0,3),"
"0","                  0,0,0,1,0,0,-1,1,-1,0,"
"0","                  0,0,0,0,1,1,0,-1,0,-1,"
"0","                  1,rep(0,9),"
"0","                  0,1,rep(0,8),"
"0","                  0,0,1,rep(0,7),"
"0","                  0,0,0,1,rep(0,6),"
"0","                  rep(0,4),1,rep(0,5),"
"0","                  rep(0,5),1,rep(0,4),"
"0","                  rep(0,6),1,rep(0,3),"
"0","                  rep(0,7),1,rep(0,2),"
"0","                  rep(0,8),1,0,"
"0","                  rep(0,9),1),"
"0","                nrow = 14, byrow = TRUE)"
"0",""
"0","# Set inequality signs"
"0","f.dir <- c(rep(""="",4),rep(""<="",10))"
"0",""
"0","# Set right hand side coefficients"
"0","maxflows <- c(3,7,5,2,7,6,1,3,8,2)"
"0","f.rhs <- c(f.con[1:4,] %*% maxflows,"
"0","           2*maxflows)"
"0",""
"0","# Solution to linear program"
"0","result <- lp(""max"", f.obj, f.con, f.dir, f.rhs)"
"0",""
"0","soln <- result$solution-maxflows # optimal flows in each segment"
"0",""
